<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Consulta Rápida - Médico Virtual May Roga</title>
</head>
<body>
  <h1>Consulta Rápida — 45s • $1</h1>

  <textarea id="quick-text" placeholder="Describe brevemente tu problema (orientación general)"></textarea>
  <br>
  <button id="quick-send">Pagar y Enviar $1</button>
  <div id="quick-result"></div>
  
  {% if access_granted %}
    <br>
    <button onclick="window.location.href='/gratis'">Entrar Gratis</button>
  {% endif %}

  <script>
    document.getElementById('quick-send').addEventListener('click', async ()=>{
      const text = document.getElementById('quick-text').value.trim();
      if(!text) return alert("Escribe tu consulta rápida.");
      const nick = prompt("Apodo para la sesión:");
      if(!nick) return alert("Apodo obligatorio.");
      // Crear sesión Stripe simulada
      const res = await fetch(`/pay/create-session?nickname=${encodeURIComponent(nick)}&servicio=quick`);
      const data = await res.json();
      if(data.url){ window.location.href = data.url; } 
      else alert("Error creando sesión.");
    });
  </script>
</body>
</html>
