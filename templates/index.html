<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asistente May Roga</title>
<script src="https://js.stripe.com/v3/"></script>
<style>
body { font-family:Arial,sans-serif; background:#f0f2f5; margin:0; padding:20px; display:flex; justify-content:center; }
.container { background:#fff; padding:20px; border-radius:16px; width:100%; max-width:900px; box-shadow:0 6px 20px rgba(0,0,0,0.15); }
.title-box { background:#8e24aa; color:#fff; padding:15px; border-radius:12px; text-align:center; font-size:1.8em; margin-bottom:20px; }
.service { border-radius:12px; padding:15px; margin-bottom:15px; background:#4CAF50; color:#fff; font-weight:bold; }
button { padding:8px 16px; margin-top:8px; border:none; border-radius:8px; cursor:pointer; font-weight:bold; }
button:hover { background:#e0e0e0; }
</style>
</head>
<body>
<div class="container">
<div class="title-box">Asistente May Roga</div>

<div id="services"></div>
<div style="margin:20px 0; text-align:center;">
<input id="secret-input" type="password" placeholder="Ingresa tu código secreto">
<button onclick="unlockAllServices()">Desbloquear Servicios</button>
</div>

<script>
const backendURL="https://asistente-virtual-may-roga.onrender.com";
const SERVICES=[
    {name:"Risoterapia y Bienestar Natural", price:8, duration:300},
    {name:"Servicio Express", price:3, duration:48},
    {name:"HOROSCOPO Y CONSEJOS DE VIDA", price:6, duration:80},
    {name:"Té Mágico en 2 Minutos", price:3.99, duration:120},
    {name:"Infusión Anti-Estrés", price:5.99, duration:120},
    {name:"Batido Energético Natural", price:3.99, duration:120},
    {name:"Mini Guía de Plantas Curativas", price:3.99, duration:120},
    {name:"Respiración Verde Express", price:3.99, duration:120},
    {name:"Risa Relámpago", price:3.99, duration:120},
    {name:"Motívate en un Minuto", price:3.99, duration:90},
    {name:"Respira y Sonríe", price:3.99, duration:120},
    {name:"Confianza Express", price:5.99, duration:120},
    {name:"Optimismo al Instante", price:3.99, duration:60},
    {name:"Horóscopo Flash", price:3.99, duration:60},
    {name:"Consejo del Día", price:5.99, duration:90},
    {name:"Amor Instantáneo", price:3.99, duration:60},
    {name:"Abundancia en 2 Minutos", price:5.99, duration:120},
    {name:"Mensaje de tu Estrella", price:3.99, duration:120},
    {name:"Mini Diagnóstico de Hábitos", price:3.99, duration:120},
    {name:"Ejercicio TVid Express", price:3.99, duration:120},
    {name:"Prevención en un Minuto", price:5.99, duration:60},
    {name:"Reto 3 Días Express", price:5.99, duration:120},
    {name:"Tracker de Bienestar Diario", price:3.99, duration:60},
    {name:"Receta Verde Express", price:3.99, duration:120},
    {name:"Té Relajante Rápido", price:5.99, duration:120},
    {name:"Batido Creativo", price:3.99, duration:120},
    {name:"Infusión para Claridad Mental", price:5.99, duration:120},
    {name:"Mini Detox Express", price:3.99, duration:120}
];

const servicesDiv=document.getElementById("services");
SERVICES.forEach(s=>{
    const div=document.createElement("div");
    div.className="service";
    div.innerHTML=`<h2>${s.name}</h2><p>Precio: $${s.price}</p><p>Duración: ${Math.floor(s.duration/60)}:${(s.duration%60).toString().padStart(2,"0")} min</p>
    <button onclick="buyService('${s.name}',${s.price})">Comprar</button>`;
    servicesDiv.appendChild(div);
});

async function buyService(product, amount){
    const res = await fetch(`${backendURL}/create-checkout-session`,{
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({product, amount})
    });
    const data = await res.json();
    if(data.url) window.open(data.url,"_blank");
    else alert("Error al crear sesión de pago");
}

async function unlockAllServices(){
    const code=document.getElementById("secret-input").value.trim();
    if(!code){ alert("Ingresa tu código"); return; }
    const res=await fetch(`${backendURL}/assistant-unlock`,{
        method:'POST', headers:{'Content-Type':'application/json'},
        body:JSON.stringify({secret: code})
    });
    const data = await res.json();
    alert(data.success ? "Servicios desbloqueados ✅" : "Código incorrecto ❌");
}
</script>
</div>
</body>
</html>
