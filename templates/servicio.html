<!-- templates/servicio.html -->
<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>{{ service }} - Asistente May Roga</title>
<style>
  body{font-family:Arial, sans-serif;background:#f9f9f9;margin:0;padding:20px}
  .container{max-width:900px;margin:0 auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
  h1{color:#2e7d32}
  .audio{margin:10px 0}
  .ex-list{margin:10px 0;padding-left:20px}
  .timer{font-weight:bold;color:#f44336;margin-top:10px}
  .meta{color:#666;font-size:14px;margin-bottom:10px}
  button{background:#4CAF50;color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer}
</style>
</head>
<body>
<div class="container">
  <h1>{{ service }}</h1>
  <p class="meta">Has accedido al servicio. Siéntate cómodo/a y sigue las instrucciones con calma.</p>

  <p>{{ dynamic_text }}</p>

  {% if content.audio %}
  <div class="audio">
    <p><strong>Audio guía (opcional)</strong></p>
    <audio controls src="{{ content.audio }}"></audio>
  </div>
  {% endif %}

  <div class="exercises">
    <h3>Ejercicios (prácticos)</h3>
    <ul class="ex-list">
      {% for e in content.exercises %}
      <li>{{ e }}</li>
      {% endfor %}
    </ul>
  </div>

  <div>
    <p>Inicia el temporizador y sigue las instrucciones en silencio; el asistente esperará y luego preguntará cómo te sientes.</p>
    <button onclick="startSession()">Iniciar sesión / Cronómetro</button>
    <div id="timer" class="timer"></div>
  </div>
</div>

<script>
let timerInterval;
function startSession(){
  const durations = {
    "Risoterapia y Bienestar Natural": 10*60,
    "Horóscopo": 2*60,
    "Respuesta Rápida": 55,
    "Servicio Personalizado": 20*60,
    "Servicio Corporativo": 20*60,
    "Servicio Grupal": 15*60
  };
  const service = "{{ service }}";
  let seconds = durations[service] || 60;
  const el = document.getElementById('timer');
  clearInterval(timerInterval);
  updateTime();
  timerInterval = setInterval(()=> {
    seconds--;
    updateTime();
    if(seconds<=0){ clearInterval(timerInterval); el.innerText="Sesión finalizada ✅"; }
  },1000);

  function updateTime(){
    const m = Math.floor(seconds/60);
    const s = seconds % 60;
    el.innerText = `Tiempo restante: ${m}:${String(s).padStart(2,'0')}`;
  }
}
</script>
</body>
</html>
